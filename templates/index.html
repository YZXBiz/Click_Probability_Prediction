<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- Make it compatible with mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Click Through Probability Prediction</title>
    <style>
      /* Style for the body */
      body {
        background: #fff;
        font-family: Arial, sans-serif;
      }

      /* Style for the form */
      .login {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }

      /* Style for the heading */
      h1 {
        color: #00008B;
        font-size: 32px;
        text-align: center;
        margin-bottom: 30px;
      }

      /* Style for the labels */
      label {
        font-size: 18px;
        margin-right: 20px;
      }

      /* Style for the radio buttons */
      input[type="radio"] {
        margin-right: 10px;
      }

      /* Style for the submit button */
      input[type="submit"] {
        display: block;
        margin: 30px auto 0;
        padding: 10px 20px;
        background-color: #00008B;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      /* Style for the prediction text */
      h2 {
        font-size: 24px;
        text-align: center;
      }

      /* Style for the error message */
      .error {
        color: red;
        font-size: 18px;
        margin-top: 20px;
      }

      /* Style for the section headings */
      .section-heading {
        font-size: 20px;
        margin-top: 30px;
        margin-bottom: 10px;
      }

      /* Style for the section separator lines */
      .section-separator {
        border-top: 1px solid #ddd;
        margin-top: 10px;
        margin-bottom: 30px;
      }

    </style>
  </head>
  <body>
    <div class="login">
      <h1>Customer Click Through Rate Prediction</h1>
      <form id="prediction-form">
        <div class="section-separator">
            <div class="section-heading"><b>User past purchases:</b></div>
          <input type="number" id="user_past_purchases" name="user_past_purchases" placeholder="enter a number (>=0)" required="required"><br>
        </div>

        <div class="section-separator">
            <div class="section-heading"><b>Email text:</b></div>
          <input type="radio" id="short_email" name="email_text" value="short_email">
          <label for="short_email" >short_email</label>
          <input type="radio" id="long_email" name="email_text" value="long_email">
          <label for="long_email">long_email</label><br>
        </div>

<div class="section-separator">
    <div class="section-heading"><b>Email version:</b></div>
  <input type="radio" id="personalized" name="email_version" value="personalized">
  <label for="personalized">personalized</label>
  <input type="radio" id="generic" name="email_version" value="generic">
  <label for="generic">generic</label>
    </div>

    <div class="section-separator">
        <div class="section-heading"><b>Weekday:</b></div>
      <input type="radio" id="Monday" name="weekday" value="Monday">
      <label for="Monday">Monday</label>
      <input type="radio" id="Tuesday" name="weekday" value="Tuesday">
      <label for="Tuesday">Tuesday</label>
      <input type="radio" id="Wednesday" name="weekday" value="Wednesday">
      <label for="Wednesday">Wednesday</label>
      <input type="radio" id="Thursday" name="weekday" value="Thursday">
      <label for="Thursday">Thursday</label>
      <input type="radio" id="Friday" name="weekday" value="Friday">
      <label for="Friday">Friday</label>
      <input type="radio" id="Saturday" name="weekday" value="Saturday">
      <label for="Saturday">Saturday</label>
      <input type="radio" id="Sunday" name="weekday" value="Sunday">
      <label for="Sunday">Sunday</label><br>
    </div>

    <div class="section-separator">
        <div class="section-heading"><b>User country:</b></div>
      <input type="radio" id="FR" name="user_country" value="FR">
      <label for="FR">FR</label>
      <input type="radio" id="UK" name="user_country" value="UK">
      <label for="UK">UK</label>
      <input type="radio" id="US" name="user_country" value="US">
      <label for="US">US</label>
      <input type="radio" id="ES" name="user_country" value="ES">
      <label for="ES">ES</label><br>
    </div>

    <div class="section-separator">
        <div class="section-heading"><b>Time of day:</b></div>
      <input type="radio" id="morning" name="time_of_day" value="morning">
      <label for="morning">morning</label>
      <input type="radio" id="evening" name="time_of_day" value="evening">
      <label for="evening">evening</label>
      <input type="radio" id="midnight" name="time_of_day" value="midnight">
      <label for="midnight">midnight</label>
      <input type="radio" id="afternoon" name="time_of_day" value="afternoon">
      <label for="afternoon">afternoon</label><br>
    </div>

    <input type="submit" value="Predict Link Click Probability">

    <br><br>

    <h2 id="prediction-text"></h2>

    <p class="error" id="error-message"></p>

  </form>
</div>
<script>
  const predictionForm = document.querySelector("#prediction-form");
  const predictionText = document.querySelector("#prediction-text");
  const errorMessage = document.querySelector("#error-message");

  predictionForm.addEventListener("submit", (event) => {
    event.preventDefault();

    const formData = new FormData(predictionForm);
    const xhr = new XMLHttpRequest();

    xhr.open("POST", "{{ url_for('predict')}}", true);
    xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

    xhr.onload = () => {
      if (xhr.status === 200) {
        const prediction = xhr.responseText;
        predictionText.textContent = prediction;
        errorMessage.textContent = "";
      } else {
        errorMessage.textContent = "Error: " +       xhr.statusText;
        predictionText.textContent = "";
      }
    };

    xhr.onerror = () => {
      errorMessage.textContent = "Error: Could not connect to server";
      predictionText.textContent = "";
    };

    xhr.send(new URLSearchParams(formData).toString());
  });
</script>
  </body>
</html>


